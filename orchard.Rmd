---
title: "Orchard"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

For Christmas my daughters received the game First Orchard. The premise of the game is as follows:

There is an orchard of 4 unique fruit trees, each of which has 4 pieces of fruit (each tree contains only one type of fruit, so there are 4 different types of fruit in the game).

There is a raven trying to make it to the orchard before all the fruit is harvested into a fruit basket.

Each turn of the game, a player rolls a six sided die. Four of the sides of the die correspond to the four different fruit trees in the orchard. One side of the die shows a fruit basket, and the remaining side shows a raven. If a player rolls a fruit, they select one fruit from that tree and place it in the fruit basket. If the tree that was rolled doesn’t have any fruit left, nothing happens and the turn ends. If a player rolls the fruit basket, they choose a single fruit from any tree and place it in the fruit basket. If a player rolls the raven, the raven moves one step closer to the orchard.

The game ends when one of two things happen: Either all of the fruit is harvested into the fruit basket or the raven reaches the orchard. The raven must be rolled 6 times in order to each the orchard. If the raven reaches the orchard before all the fruit is harvested, the game is considered lost.

Most of this game is luck based only on the roll of the die. However, there is some small strategy involved when the fruit basket is rolled. We’ll consider the following two strategies:

Highest: When the fruit basket is rolled, the player choose a fruit from the tree with the most remaining fruits and places it in the fruit basket.

Random: When the fruit basket is rolled, the player randomly selects one of the remaining fruit and places it in the fruit basket.

Create a function called orchard. This function should take a single argument strategy that is either "random" or "highest", indicating which of the above strategies will be used. The function should simulate playing the game one time using the given strategy and return either TRUE or FALSE based on whether or not the players won the game. In other words, if all the fruit is harvested, the function should return TRUE. If the raven advances six spaces before all the fruit is harvested the function should return FALSE. (20 points)

Using the orchard function from the previous step, simulate playing this game with each strategy 10,000 times and store the results. (15 points)

Based on the results obtained in step 2, calculate an estimate for the likelihood of winning (collecting all the fruit before the raven reaches the orchard) for each strategy. (10 points)

Build a 95% confidence interval on the estimates you calculated in step 3. (10 points)

Based on your estimates and associated confidence intervals, is one strategy better than the other? Explain your reasoning. (5 points)


```{r}
trees <- list(
  tree1 = rep(1, 4),
  tree2 = rep(2, 4),
  tree3 = rep(3, 4),
  tree4 = rep(4, 4))

die <- c(1, 2, 3, 4, 0, 9)

basket <- numeric()

raven <- 0

basket <- c(basket, roll)

basket <- c(basket, fruit_choice)

roll <- sample(die, 1)

if (roll %in% c(1, 2, 3, 4) & length(trees[[roll]]) > 0) {
  
  trees[[roll]] <- trees[[roll]][-1]
  
  basket <- c(basket, roll)

} else if (roll == 0) {
  
  fruit_choice <- sample(c(1, 2, 3, 4), 1)
  
  if (length(trees[[fruit_choice]]))
  
  trees[[roll]] <- trees[[roll]][-1]
  
  basket <- c(basket, fruit_choice)
  
} else if (roll == 9) {
  
  raven <- raven + 1
  
}
```

```{r}
basket <- numeric()
fruits <- c(1, 2, 3, 4)
die <- c(1, 2, 3, 4, 0, 9)
roll <- sample(die, 1)
if (roll == 9) {
  
  raven <- raven + 1
  
} else if (roll == 0) {
  
  num_fruit <- sapply(1:4, function(x) sum(basket == x))
  
  fruit_sample <- fruits[num_fruit < 4]
  
  fruit_choice <- sample(fruit_sample, 1)
  
  basket <- c(fruit_choice, basket)
  
} else {
  
  num_fruit <- sapply(1:4, function(x) sum(basket == x))
  
  fruit_sample <- fruits[num_fruit < 4]
  
  if (roll %in% fruit_sample) {
  
  basket <- c(fruit_choice, basket)
  
  }
  
}



```



```{r}
fruit_sample <- c(2, 4, 4, 5, 3, 1, 3, 1, 1)
fruit_sample <- fruit_sample[fruit_sample < 4]
```










